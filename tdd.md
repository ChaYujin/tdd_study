# TDD 적용할 수 있는 시나리오, TDD가이드라인, TDD란 무엇인가


## TDD(Test Driven Development)
>TDD 목표는 작동하는 깔끔한 코드 - Clean code that works
* 매우 짧은 개발 사이클을 반복하는 소프트웨어 개발 프로세스(방법론?)
* 반복 테스트를 이용한 소프트웨어 개발방법론
* 작은 단위의 테스트 케이스르 작성하고 이를 통과하는 코드를 추가하는 단계를 반복하여 구현.

기존 기능이 제대로 동작하는지 쉽게 확인할 수 있고, 정상 독작을 보장.
또한 TDD는 리펙토링을 개발 프로세스에 포함시켜 '변경'이라는 소프트웨어의 특성을 반영

![순서](./2.gif)

RED		: 실패하는 작은 테스트 케이스를 작성한다. (처음에는 컴파일조차 안될 수 있다.)

GREEN      : 테스트를 통과하는 (작은)코드를 작성한다.

REFACTOR   : 반복되는 코드, 긴 메소드, 큰 클래스, 긴 매개변수 목록 등등 코드를 좀 더 효율적으로 바꾸기

####애자일 개발론의 Robert C. Martin은 다음의 TDD 원칙을 제시한다.

- 실패하는 테스트를 작성하기 전에는 절대로 제품 코드를 작성하지 않는다.
- 실패하는 테스트 코드를 한 번에 하나 이상 작성하지 않는다.
- 현재 실패하고 있는 테스트를 통과하기에 충분한 정도를 넘어서는 제품 코드를 작성하지 않는다.

####다음의 역량이 TDD 개발에 있어 개발자에게 중요할 것 같다.

테스트 케이스 작성 능력 	: 테스트 케이스 자체가 의미있지 않으면 개발된 코드를 신뢰할 수 없다.
API 숙련도 			: 테스트 케이스를 먼저 작성하면 컴파일 조차 되지 않아 개발 도구의 자동 완성 기능의 도움을 받지 못할 수 있다.
설계 및 리펙토링 능력 	: 매 단계마다 상황에 맞는 설계적 결정을 해야 한다. 전체 SW 구조에 대한 직관을 가질 필요가 있다.

> 난 테스트 케이스 작성 능력이나, 설계 및 리펙토링능력이 모두 떨어짐...

테스트 케이스가 의미있으려면 테스트 케이스는 정상적으로 끝까지 수행되어야 한다. 
테스트의 결과 중 개발자가 의도 하지 않은 문제 – 예상치 못한 Exception 등 
실패가 아닌 오류로 기록된다. 테스트 케이스가 정상적으로 끝까지 진행되어 오류가 아닌 실패로 기록되도록 하자.

테스트 클래스를 생성/사용할 때는 제품코드와 ‘소스 코드는 다르게, 패키지는 동일, 컴파일된 클래스는 다른 곳으로’ 설정하는 방법이 가장 많이 쓰인다.
???? 무슨말??

 폴더만으로 제품 코드와 분리하면 테스트만을 위한 라이브러리를 구별하기가 어려워진다.

TDD 장점
-

- 개발자의 방향을 잃지 않게 유지 : 현재 자신의 개발 내용 및 진척 사황을 항상 살펴볼 수 있다.
- 품질 높은 소프트웨어 모듈 보유 : 간결한 코드 유지 가능
- 자동화된 단위 테스트 케이스 소유 : 개발자가 필요한 시점에 언제든 수행 할 수 있으며, 시스템의 이상 유무를 바로 확인할 수 있다.
- 사용설명서 & 의사 소통의 수단 : 작성된 테스트 케이스는 제품 코드 사용 설명서이자 동시에 다른 개발자와 소통하는 커뮤니케이션 통로가 됨.
- 설계 개선 : 테스트 케이스 작성 시 개발에 포함된 다양한 설계요소들에 대해 고민하게 된다.
      흔히 테스트하기 어렵다고 생각되는 코드들은 객체 설계 원리 중 기본에 해당하는 원칙들이 잘못 적용됐거나,
      충분히 고려되지 않았을 가능성이 높다.
      TDD를 진행하면서 테스트가 가능하도록 설계 구조를 고민하다 보면 자연스럽게 디자인을 개선하게 된다.
- 보다 자주 성공한다 : TDD는 주기를 짧게 설정하도록 권한다. 개발자는 성취감을 자주 느낄 수 있다.

TDD 단점
-

출처 : http://www.hoons.net/Lecture/View/644
- 기존 개발 프로세스에 테스트 케이 설계까지 추가되므로 코드생산성이 떨어짐 
- 코드 퀄리티 보다는 빠른 결과물을 원하는 환경이라면 쉽게 도입이 어려움 왜냐하면 개발자들이 TDD 를 공부해야 하고 추가적으로 테스트 코드를 작성해야 하기 때문이다. 
- 필자의 경험으로 처음에는 익숙해지기 위한 시간 때문에 1-2달은 적응시간이 걸린다. 
- TDD가 최소한의 객체지향 프로그래밍을 요구하는 이상 보통 정도하는 1-2년 차 개발자라도 조금 어렵다는 생각이 들 수 있다. 
때문에 객체지향에 올바른 이해를 가지고 있는 리드 개발자가 TDD 프로젝트를 리드해 갈 필요가 있다.
- 추가적으로 결국 미래를 봤을 때 투자한 시간을 충분히 벌 수 있는 잠재력이 충분하다 하더라도 결국 납기일이라는 몹쓸 데드라인이 잡히면 “글쎄,,” 라는 생각이 들 수 있다. 
갑을병정 내려가는 프로젝트일수록 퀄리티 보다는 개발기간과 타이밍이 중요하기 마련이고 또한 소프트웨어에서 주인의식을 가지기 힘들 수 있기 때문이다.
 
마지막으로 개인적으로 체험한 경험적인 이슈가 있다면 TDD로 프로젝트를 진행하면서 테스트가 어려운 예외가 생길 수 있는데 그것 때문에 고민하는 순간이 찾아오게 된다. 
원칙을 깰 수는 없고 꼼수가 있기는 한데 그 꼼수를 위해서 구조를 바꾸자니 이건 아무래도 아닌 것 같고, 테스트는 말 그대로 테스트일뿐 실제 코드가 더 중요한 상황인데도 불구하고 테스트 원칙 때문에 쉽게 넘어가지 못하는 그런 경우다.
 
아무튼 이런 단점들이 있다고 하더라도 개발자의 커리어에 있어서는 반드시 TDD를 도입해야만 한다고 필자는 이야기 하고 싶다. 
먼저 자신의 객체지향적인 코딩 능력을 향상시킬 수 있기 때문이다. 
더욱이 S.I회사가 아닌 자력 소프트웨어를 만드는 경우에서는 더욱더 그렇다. 
회사의 입장에서도 처음 TDD의 도입에 대한 실이 많아 보일 수는 있다 하더라도 TDD 도입을 통하여 보다 튼튼한 소프트웨어를 만들 수 있을뿐더러 향후에 관리에도 더 용이하게 된다.

TDD 의 한계
-

TDD 선구자인 Kent Beck 은 다음 두 가지를  TDD가 현재 접근하기 어려운 분야라고 말한다.

동시성(Concurrency)
보안 등의 비기능적 요소
이 외에 국내 TDD 도서 저자인 채수원씨는 본인의 도서에서 아래와 같이 추가적인 어려움들을 덧붙였다. 불가능하진 않지만 쉽지 않다는 의미로 받아들이면 될 것 같다.

접근 제한자 메소드 : 현재는 public 메소드만 테스트해도 무방하다는 경향이 대세로 보이지만, 필요에 따라 public 으로 테스트 후 접근 제한자를 수정하는 방법도 있다.
GUI : 뷰 레이어와 로직 레이어를 확실히 분리시켜 설계할 필요가 있다.
의존성 모듈 테스트 (target = A but A -> B) : 타겟 A 테스트를 위해 B 도 필요하다. 그러나  B가 아직 준비가 되어 있지 않다면 테스트가 이루어질 수 없다. 보통 이런 경우 B의 Mock객체를 생성하여 B는 문제없음을 가정하고 테스트 한다.

>접근제한자 메소드 한계 : TDD 단계를 준수하면  Private 메소드는 빨강 – 초록 단계를 지나 리펙토링 단계에서 생성된다.
Private 메소드는 새로운 테스트 케이스가 필요한 것이 아니라 이미 통과한 테스트의 리펙토링 결과다. 
별도로 접근제한자를 변경해서 테스트할 필요가 없다. 그렇게 되도록 TDD 개발 단계를 준수하자.

왜 씀??
-

프로그램의 모든 코드가 테스트 되기 때문에 버그의 발생 가능성이 줄어듬.
테스트 자체가 요구사항을 분명하게 드러나게 해주는 효과가 있고,
테스트에 맞게 코딩하다보면 자연스럽게 프로그램의 디자인이 심플해질 수 있음.
테스트가 잘 작성되어 있으면 예상치 못한 예외가 발생됨을 쉽게 알아 차릴 수 있으므로,
리펙토링 및 디버깅작업이 순조롭다.

출처: http://cocomo.tistory.com/319 [Cocomo Coding]
https://m.blog.naver.com/PostView.nhn?blogId=jaeik714&logNo=220204957679&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F
https://nesoy.github.io/articles/2017-01/TDD
